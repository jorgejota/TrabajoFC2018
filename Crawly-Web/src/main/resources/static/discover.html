<!DOCTYPE html>
<html>
<head>
	<title>Crawly | UPLOAD</title>
	<link rel="stylesheet" href="css/fontello.css">
	<link rel="stylesheet" href="css/main.css">
	<script src="js/jquery-3.3.1.min.js"></script>
	<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
	<style>
	#porcentajes{
		display: none;
	}
	.progress {
		height: 30px;
	}
	.inicio{
		width: 0%;
	}
	.final{
		width: 100%;
	}
	.animacion{
		transition: all 2s ease .5s;
	}
	#information-works{
		text-align: center;
	}
	.resizeText {
		margin: auto;
		font-size: 20px;
	}
	#reiniciarDiscover{
		display: none;
		text-align: center;
		margin: auto;
	}
	#upload-file-message{
		margin: auto;
		text-align: center;
	}
</style>
</head>
<body>
	<header>
		<div class="contenedor">
			<h1>Crawly</h1>
			<input type="checkbox" id="menu-bar">
			<label class="icon-menu" for="menu-bar"></label>
			<nav class="menu">
				<a href="index.html">Home</a>
				<a href="discover.html">Discover</a>
				<a href="extract.html">Extract</a>
				<a href="makeYourOwn.html">Make</a>
			</nav>
		</div>
	</header>
	<div id="selectUploadPDF" class="contenedor">
		<h2 id="chooseOption"> Know what light pollution topic your pdf is talking about</h2>
		<h3 id="chooseOption2"> Our algorithm indicates the probability that the selected pdf belongs to a topic</h3>
	</div>
	<div class="form-div">
		<div id="melajuego">
			<form id="upload-file-form">
				<label for="upload-file-input" class="inputlabel">
					<i class="icon-pdf"></i>
					<span id="label-span"><u>Choose file</u></span>
				</label>
				<input id="upload-file-input" accept=".pdf" type="file" name="uploadfile" accept="*" />
			</form>
		</div>
	</div>
	<span id="upload-file-message" class="py-8"></span>
	<div id="cargaModelo">
		<h3 id="relevant"> Detecting if your PDF is relevant ... </h3>
		<div id="preloader_1">
			<span></span>
			<span></span>
			<span></span>
			<span></span>
			<span></span>
		</div>
	</div>
	<div id="porcentajes" class="container text-center py-5">
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra1" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto1" class="resizeText justify-content-center d-flex position-absolute w-100">Information - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra2" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto2" class="resizeText justify-content-center d-flex position-absolute w-100">Well-being - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra3" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto3" class="resizeText justify-content-center d-flex position-absolute w-100">Security - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra4" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto4" class="resizeText justify-content-center d-flex position-absolute w-100">Measurements - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra5" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto5" class="resizeText justify-content-center d-flex position-absolute w-100">Animals - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra6" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto6" class="resizeText justify-content-center d-flex position-absolute w-100">Models - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra7" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto7" class="resizeText justify-content-center d-flex position-absolute w-100">Energy - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra8" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto8" class="resizeText justify-content-center d-flex position-absolute w-100">Enviroment - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra9" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto9" class="resizeText justify-content-center d-flex position-absolute w-100">Health - </small>
			</div>
		</div>
		<div class="py-1">
			<div class="progress position-relative">
				<div id="barra10" class="progress-bar progress-bar-striped progress-bar-animated inicio animacion" role="progressbar" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100"></div>
				<small id="texto10" class="resizeText justify-content-center d-flex position-absolute w-100">Urban planning - </small>
			</div>
		</div>
	</div>
	<div class="container py-4" id="reiniciarDiscover">
		<button type="button" class="btn btn-primary" onClick="window.location.reload()">Try Another</button>
	</div>
	<div id="information-works" class="position-relative">
		<h3 id="chooseOption">We have 10 diferents topics</h3>
		<h4 id="chooseOption2">Each topic has 10 main words </h4>
		<div class="card-group">
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Information</h5>
					<p class="card-text">Information, time, need, such, problem, well, people, service, provide, case</p>
				</div>
			</div>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Well-being</h5>
					<p class="card-text">Cancer, breast, night, risk, sleep, health, exposure, woman, melatonin, level</p>
				</div>
			</div>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Security</h5>
					<p class="card-text">Lighting, lamp, road, street, energy, crime, impact, increase, effect, luminaire</p>
				</div>
			</div>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Measurements</h5>
					<p class="card-text">Sky, night, brightness, star, measurement, value, model, pollution, spectral, time</p>
				</div>
			</div>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Animals</h5>
					<p class="card-text">Bat, species, insect, moth, nocturnal, moon, activity, bird, night, trap</p>
				</div>
			</div>
		</div>
		<div class="card-group">
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Models</h5>
					<p class="card-text">Urban, value, nighttime, remote, dmsp, dnb, city, pixel, model, sens</p>
				</div>
			</div>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Energy</h5>
					<p class="card-text">Plant, energy, power, engineering, rate, value, control, surface, water, increase</p>
				</div>
			</div>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Enviroment</h5>
					<p class="card-text">Disorientation, model, higher, different, difference, effect, day, comparison, environmental, value</p>
				</div>
			</div>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Health</h5>
					<p class="card-text">Circadian, melatonin, sleep, rhythm, clock, time, exposure, effect, human, mouse</p>
				</div>
			</div>
			<div class="card" style="width: 18rem;">
				<div class="card-body">
					<h5 class="card-title">Urban planning</h5>
					<p class="card-text">Artificial, night, effect, pollution, species, bird, lighting, time, urban, day</p>
				</div>
			</div>
		</div>
	</div>
	<footer id="footer">
		<div class="contenedor">
			<ul class="rights">
				<li>&copy; Copyright 2018 OEG-UPM</li>
				<li>All Rights Reserved</li>
				<li><a href="https://github.com/jorgejota/TrabajoFC2018" class="icon-github"></a></li>
			</ul>
		</div>
	</footer>
	<!-- Javascript functions -->
	<script>

    // bind the on-change event for the input element (triggered when a file
    // is chosen)
    $(document).ready(function() {
    	$("#upload-file-input").on("change", function(){
    		document.getElementById('melajuego').style.display="none";
    		document.getElementById('upload-file-input').style.display=" none";
    		document.getElementById('cargaModelo').style.display=" block";
    		uploadFile();
    	});
    });

    /**
     * Upload the file sending it via Ajax at the Spring Boot server.
     */
     function uploadFile() {
     	$.ajax({
     		url: "/uploadFile",
     		type: "POST",
     		data: new FormData($("#upload-file-form")[0]),
     		enctype: 'multipart/form-data',
     		processData: false,
     		contentType: false,
     		cache: false,
     		success: function (response) {
          // Handle upload success
          console.log("Esto es acierto");
          document.getElementById('cargaModelo').style.display=" none";
          document.getElementById('reiniciarDiscover').style.display="block";
          if(response.numero == 0){
          	document.getElementById('porcentajes').style.display="block";
          	for (i = 0; i < response.porcentage.length; i++) {
          		document.getElementById("barra" + (i+1)).style.width = ''+response.porcentage[i]+'%';
          		document.getElementById("texto" + (i+1)).innerHTML += ''+response.porcentage[i]+'%';
          	};
          }
          else{
          	document.getElementById('upload-file-message').innerHTML= response.status;
          }
          //$("#upload-file-message").text("File succesfully uploaded " + response.porcentage);
      },
      error: function (response) {
      	console.log("Esto es fallo");
      	document.getElementById('cargaModelo').style.display=" none";
      	$("#upload-file-message").text(
      		"An error has ocurred");
      }
  });
    } // function uploadFile
</script>

</body>

</html>